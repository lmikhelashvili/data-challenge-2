---
title: "communications"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lubridate)
library(forcats)
library(RColorBrewer)
```


```{r}
data_Fri <- read_csv("comm-data-Fri.csv")
```

```{r}
data_Sat<- read_csv("comm-data-Sat.csv")
```

```{r}
data_Sun <- read_csv("comm-data-Sun.csv")
```

#Friday

```{r}
external_fri <- data_Fri%>%
  filter(to == "external" | from == "external")%>%
  mutate(timeblock = hour(Timestamp))
```

### The number of external texts from each location

For every time block, Wet Land has the most texts made from. 2nd most texts made from Tundra Land 8-17 time blocks; 17-22 Entry Corridor.
```{r}
timeblock_location <- external_fri%>%
  group_by(location, timeblock)%>%
  summarize(
    num = n()
  )%>%
  arrange(desc(num))
```

*What time blocks are the most popular?*
17 is the most populated time block. That is when the shift from Tundra land to Entry Corridor happens. Most of the texts are sent afternoon.

```{r}
external_fri%>%
  group_by(timeblock)%>%
  summarize(num = n())%>%
  arrange(desc(num))
```


Are there repeating numbers that made external calls?



```{r}
repeating_numbers <- external_fri%>%
  group_by(from,timeblock, location)%>%
  summarize(
    num = n()
  )
 # arrange(from, Timestamp)
```

time series of the external texts on Friday

```{r}
ggplot(data = external_fri , aes(timeblock))+
  geom_bar(aes(timeblock, fill = location))+
  scale_fill_brewer(palette = "Set2")+
  labs(
    title = "Friday: Distribution of the External Texts sent from the park",
    subtitle = "Number of external texts sent from which location in which time period"
  )
```






# Sunday

```{r}
external_sun <- data_Sun%>%
  filter(to == "external" | from == "external")%>%
  mutate(timeblock = hour(Timestamp))
```

### The number of external texts from each location

```{r}
timeblock_location_sun <- external_sun%>%
  group_by(location, timeblock)%>%
  summarize(
    num = n()
  )%>%
  arrange(desc(num))
```

*What time blocks are the most popular?*
11am is the most populated time block.

```{r}
external_sun%>%
  group_by(timeblock)%>%
  summarize(num = n())%>%
  arrange(desc(num))
```

Are there repeating numbers that made external calls?

```{r}
repeating_numbers <- external_fri%>%
  group_by(from,timeblock, location)%>%
  summarize(
    num = n()
  )
 # arrange(from, Timestamp)
```

time series of the external texts on Friday

```{r}
ggplot(data = external_sun , aes(timeblock))+
  geom_bar(aes(timeblock, fill = location))+
  scale_fill_brewer(palette = "Set2")+
  labs(
    title = "Sunday: Distribution of the External Texts sent from the park",
    subtitle = "Number of external texts sent from which location in which time period"
  )
```





